###############################################################################
#
# IAR C/C++ Compiler V7.10.1.973/W32 for MSP430           02/Aug/2021  17:19:13
# Copyright 1996-2017 IAR Systems AB.
# Standalone license - IAR Embedded Workbench for Texas Instruments MSP430
#
#    __rt_version  =  3
#    __double_size =  32
#    __reg_r4      =  free
#    __reg_r5      =  free
#    __pic         =  no
#    __core        =  430X
#    __data_model  =  large
#    __code_model  =  large
#    Source file   =  D:\Dev\IAR\5529_MPU6050\HardWare\mpu6050\mpu6050.c
#    Command line  =  
#        -f C:\Users\Jeans\AppData\Local\Temp\EW8FF7.tmp
#        (D:\Dev\IAR\5529_MPU6050\HardWare\mpu6050\mpu6050.c -D NDEBUG -D
#        RAM_VECTOR -lC D:\Dev\IAR\5529_MPU6050\Release\List -lA
#        D:\Dev\IAR\5529_MPU6050\Release\List -o
#        D:\Dev\IAR\5529_MPU6050\Release\Obj --debug -D__MSP430F5529__ -e
#        --double=32 --dlib_config D:\Dev\IAR\430\lib\dlib\dl430xllfn.h -I
#        D:\Dev\IAR\5529_MPU6050\ -I D:\Dev\IAR\5529_MPU6050\Drivers\inc\ -I
#        D:\Dev\IAR\5529_MPU6050\Drivers\src\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\led\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\key\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\lcd\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\lcd_api\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\nrf24l01\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\oled\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\delay\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\2.2TFT\ -I
#        D:\Dev\IAR\5529_MPU6050\System\ -I D:\Dev\IAR\5529_MPU6050\System\inc\
#        -I D:\Dev\IAR\5529_MPU6050\System\src\ -I
#        D:\Dev\IAR\5529_MPU6050\User\ -I D:\Dev\IAR\5529_MPU6050\User\USER\ -I
#        D:\Dev\IAR\5529_MPU6050\HardWare\mpu6050\ --core=430X
#        --data_model=large -Oh --multiplier=32 --hw_workaround=CPU40
#        --hw_workaround=nop_after_lpm -DNDEBUG --code_model=large)
#    Locale        =  Chinese (Simplified)_CHN.936
#    List file     =  D:\Dev\IAR\5529_MPU6050\Release\List\mpu6050.lst
#    Object file   =  D:\Dev\IAR\5529_MPU6050\Release\Obj\mpu6050.r43
#
###############################################################################

D:\Dev\IAR\5529_MPU6050\HardWare\mpu6050\mpu6050.c
      1          #include <mpu6050.h>

   \                                 In  segment DATA16_AN, at 0x220
   \   union <unnamed> __data16 _A_PBIN_L
   \                     _A_PBIN_L:
   \   000000                DS8 2

   \                                 In  segment DATA16_AN, at 0x222
   \   union <unnamed> __data16 _A_PBOUT_L
   \                     _A_PBOUT_L:
   \   000000                DS8 2

   \                                 In  segment DATA16_AN, at 0x224
   \   union <unnamed> __data16 _A_PBDIR_L
   \                     _A_PBDIR_L:
   \   000000                DS8 2
      2          #include <include.h>
      3          //******************************************************************************
      4          //! 函数名：                 IIC_Start
      5          //! 功能：                     IIC起始信号
      6          //! 作者：                      帅帅
      7          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
      8          void IIC_Start(){
   \                     IIC_Start:
      9              SDA_OUT;
   \   000000   D2D32402     BIS.B   #0x1, &0x224
     10              SDA_H;                    //拉高数据线
   \   000004   D2D32202     BIS.B   #0x1, &0x222
     11              SCL_OUT;
   \   000008   ........     CALLA   #?Subroutine4
     12              SCL_H;                    //拉高时钟线
     13              DELAY_US(2);                 //延时
     14              SDA_L;                    //产生下降沿
   \                     ??CrossCallReturnLabel_51:
   \   00000C   D2C32202     BIC.B   #0x1, &0x222
     15              DELAY_US(2);                  //延时
   \   000010   ....         JMP     ??Subroutine3_0
   \   000012                REQUIRE _A_PBDIR_L
   \   000012                REQUIRE _A_PBOUT_L
     16              SCL_L;                    //拉低时钟线
     17          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ??Subroutine3_0:
   \   000000                ////////////// Start of 50 cycles delay.
   \   000000   3F400F00     MOV.W   #0xf, R15
   \                     ??Subroutine28_0:
   \   000004   3F53         ADD.W   #0xffff, R15
   \   000006   FE2F         JC      ??Subroutine28_0
   \   000008                ////////////// End of delay code.
   \   000008   E2C32202     BIC.B   #0x2, &0x222
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine25:
   \   000000   E2D32402     BIS.B   #0x2, &0x224
   \   000004   E2D32202     BIS.B   #0x2, &0x222
   \   000008   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine4:
   \   000000   ........     CALLA   #?Subroutine25
   \                     ??CrossCallReturnLabel_46:
   \   000004                REQUIRE ??Subroutine4_0
   \   000004                // Fall through to label ??Subroutine4_0

   \                                 In  segment CODE, align 2
   \                     ??Subroutine4_0:
   \   000000                ////////////// Start of 50 cycles delay.
   \   000000   3F400F00     MOV.W   #0xf, R15
   \                     ??Subroutine30_0:
   \   000004   3F53         ADD.W   #0xffff, R15
   \   000006   FE2F         JC      ??Subroutine30_0
   \   000008                ////////////// End of delay code.
   \   000008   1001         RETA
     18          //******************************************************************************
     19          //! 函数名：                 IIC_Stop
     20          //! 功能：                     IIC停止信号
     21          //! 作者：                      帅帅
     22          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
     23          void IIC_Stop(){
   \                     IIC_Stop:
     24              SDA_OUT;
   \   000000   D2D32402     BIS.B   #0x1, &0x224
     25              SDA_L;                    //拉低数据线
   \   000004   D2C32202     BIC.B   #0x1, &0x222
     26              SCL_OUT;
   \   000008   ........     CALLA   #?Subroutine4
     27              SCL_H;                    //拉高时钟线
     28              DELAY_US(2);                   //延时
     29              SDA_H;                    //产生上升沿
   \                     ??CrossCallReturnLabel_52:
   \   00000C   D2D32202     BIS.B   #0x1, &0x222
     30              DELAY_US(2);                  //延时
   \   000010   ....         JMP     ??Subroutine4_0
   \   000012                REQUIRE _A_PBDIR_L
   \   000012                REQUIRE _A_PBOUT_L
     31          }
     32          //******************************************************************************
     33          //! 函数名：                 IIC_SendACK
     34          //! 功能：                     IIC发送应答信号
     35          //! 作者：                      帅帅
     36          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
     37          void IIC_SendACK(uint8_t ack){
   \                     IIC_SendACK:
     38              SDA_OUT;
   \   000000   D2D32402     BIS.B   #0x1, &0x224
     39              SCL_OUT;
   \   000004   E2D32402     BIS.B   #0x2, &0x224
     40              if(ack) SDA_H;
   \   000008   4C93         CMP.B   #0x0, R12
   \   00000A   ........     CALLA   #?Subroutine26
     41              else SDA_L;
     42          //    SDA = ack;                  //写应答信号
     43              SCL_H;                    //拉高时钟线
   \                     ??CrossCallReturnLabel_47:
   \   00000E   ........     CALLA   #?Subroutine3
     44              DELAY_US(2);                  //延时
     45              SCL_L;                    //拉低时钟线
     46              DELAY_US(2);                  //延时
   \                     ??CrossCallReturnLabel_34:
   \   000012   ....         JMP     ??Subroutine4_0
   \   000014                REQUIRE _A_PBDIR_L
   \   000014                REQUIRE _A_PBOUT_L
     47          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine3:
   \   000000   E2D32202     BIS.B   #0x2, &0x222
   \   000004                REQUIRE ??Subroutine3_0
   \   000004                // Fall through to label ??Subroutine3_0

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine27:
   \   000000   D2D32202     BIS.B   #0x1, &0x222
   \   000004   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine26:
   \   000000   0124         JEQ     ??IIC_SendACK_0
   \   000002   ....         JMP     ?Subroutine27
   \                     ??IIC_SendACK_0:
   \   000004   D2C32202     BIC.B   #0x1, &0x222
   \   000008   1001         RETA
     48          //******************************************************************************
     49          //! 函数名：                 IIC_RecvACK
     50          //! 功能：                     IIC接收应答信号
     51          //! 作者：                      帅帅
     52          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
     53          uint8_t IIC_RecvACK(){
   \                     IIC_RecvACK:
     54              uint8_t cy;
     55              SCL_OUT;
   \   000000   ........     CALLA   #?Subroutine25
     56              SCL_H;                    //拉高时钟线
     57              SDA_IN;
   \                     ??CrossCallReturnLabel_45:
   \   000004   D2C32402     BIC.B   #0x1, &0x224
     58              DELAY_US(2);                 //延时
   \   000008   ........     CALLA   #??Subroutine4_0
     59              if(SDA_DATA)    cy=1;
   \                     ??CrossCallReturnLabel_53:
   \   00000C   5C422002     MOV.B   &0x220, R12
     60              else            cy=0;
     61          //    cy = SDA;                   //读应答信号
     62              SCL_L;                    //拉低时钟线
   \   000010   E2C32202     BIC.B   #0x2, &0x222
     63              DELAY_US(2);                //延时
   \   000014   ........     CALLA   #??Subroutine4_0
     64              SDA_OUT;
   \                     ??CrossCallReturnLabel_54:
   \   000018   D2D32402     BIS.B   #0x1, &0x224
     65              return cy;
   \   00001C   5CF3         AND.B   #0x1, R12
   \   00001E   1001         RETA
   \   000020                REQUIRE _A_PBDIR_L
   \   000020                REQUIRE _A_PBOUT_L
   \   000020                REQUIRE _A_PBIN_L
     66          }
     67          //******************************************************************************
     68          //! 函数名：                 IIC_SendByte
     69          //! 功能：                     向IIC总线发送一个字节数据
     70          //! 作者：                      帅帅
     71          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
     72          void IIC_SendByte(uint8_t dat){
   \                     IIC_SendByte:
     73              uint8_t i;
     74              SDA_OUT;
   \   000000   D2D32402     BIS.B   #0x1, &0x224
     75              for (i=0; i<8; i++){          //8位计数器
   \   000004   4E43         MOV.B   #0x0, R14
   \   000006   4C4C         MOV.B   R12, R12
     76                  if((dat<<i)&0x80)   SDA_H;
   \                     ??IIC_SendByte_0:
   \   000008   0F4C         MOV.W   R12, R15
   \   00000A   5E83         SUB.B   #0x1, R14
   \   00000C   0230         JN      ??IIC_SendByte_3
   \   00000E                RPT     R14
   \   00000E   CE180F5F     RLAX.W  R15
   \                     ??IIC_SendByte_3:
   \   000012   5E53         ADD.B   #0x1, R14
   \   000014   7FB08000     BIT.B   #0x80, R15
   \   000018   ........     CALLA   #?Subroutine21
     77                  else                SDA_L;
     78                 // SDA = cy;               //送数据口
     79                  SCL_OUT;
     80                  SCL_H;                //拉高时钟线
     81                  DELAY_US(2);              //延时
   \                     ??CrossCallReturnLabel_41:
   \   00001C   ........     CALLA   #?Subroutine23
     82                  SCL_L;                //拉低时钟线
   \                     ??CrossCallReturnLabel_30:
   \   000020   ........     CALLA   #?Subroutine8
     83                  DELAY_US(2);              //延时
     84              }
   \                     ??CrossCallReturnLabel_1:
   \   000024   5E53         ADD.B   #0x1, R14
   \   000026   7E92         CMP.B   #0x8, R14
   \   000028   EF2B         JNC     ??IIC_SendByte_0
     85              IIC_RecvACK();
   \   00002A   ........     BRA     #IIC_RecvACK
   \   00002E                REQUIRE _A_PBDIR_L
   \   00002E                REQUIRE _A_PBOUT_L
     86          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine8:
   \   000000   E2C32202     BIC.B   #0x2, &0x222
   \   000004                REQUIRE ?Subroutine23
   \   000004                // Fall through to label ?Subroutine23

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine23:
   \   000000                ////////////// Start of 50 cycles delay.
   \   000000   3F400F00     MOV.W   #0xf, R15
   \                     ??Subroutine23_1:
   \   000004   3F53         ADD.W   #0xffff, R15
   \   000006   FE2F         JC      ??Subroutine23_1
   \   000008                ////////////// End of delay code.
   \   000008   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine21:
   \   000000   ........     CALLA   #?Subroutine26
   \                     ??CrossCallReturnLabel_48:
   \   000004   ....         JMP     ?Subroutine25
     87          
     88          //******************************************************************************
     89          //! 函数名：                 IIC_RecvByte
     90          //! 功能：                     从IIC总线接收一个字节数据
     91          //! 作者：                      帅帅
     92          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
     93          uint8_t IIC_RecvByte(){
   \                     IIC_RecvByte:
     94              uint8_t i;
     95              uint8_t dat = 0,cy;
   \   000000   4C43         MOV.B   #0x0, R12
     96              SDA_OUT;
   \   000002   ........     CALLA   #?Subroutine6
     97              SCL_OUT;
     98              SDA_H;                    //使能内部上拉,准备读取数据,
     99              SDA_IN;
   \                     ??CrossCallReturnLabel_49:
   \   000006   D2C32402     BIC.B   #0x1, &0x224
    100              for (i=0; i<8; i++){         //8位计数器
   \   00000A   7E42         MOV.B   #0x8, R14
    101                  dat<<= 1;
    102                  SCL_H;                //拉高时钟线
   \                     ??IIC_RecvByte_0:
   \   00000C   E2D32202     BIS.B   #0x2, &0x222
    103                  DELAY_US(2);             //延时
   \   000010   ........     CALLA   #?Subroutine23
    104                  if(SDA_DATA)    cy=1;
    105                  else            cy=0;
    106                  dat |= cy;             //读数据
   \                     ??CrossCallReturnLabel_31:
   \   000014   5F422002     MOV.B   &0x220, R15
   \   000018   5FF3         AND.B   #0x1, R15
   \   00001A   4C5C         RLA.B   R12
   \   00001C   4CDF         BIS.B   R15, R12
    107                  SCL_L;                //拉低时钟线
   \   00001E   ........     CALLA   #?Subroutine8
    108                  DELAY_US(2);             //延时
    109              }
   \                     ??CrossCallReturnLabel_0:
   \   000022   7E53         ADD.B   #0xff, R14
   \   000024   4E93         CMP.B   #0x0, R14
   \   000026   F223         JNE     ??IIC_RecvByte_0
    110              SDA_OUT;
   \   000028   D2D32402     BIS.B   #0x1, &0x224
    111              return dat;
   \   00002C   1001         RETA
   \   00002E                REQUIRE _A_PBDIR_L
   \   00002E                REQUIRE _A_PBOUT_L
   \   00002E                REQUIRE _A_PBIN_L
    112          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine6:
   \   000000   D2D32402     BIS.B   #0x1, &0x224
   \   000004   E2D32402     BIS.B   #0x2, &0x224
   \   000008                REQUIRE ?Subroutine27
   \   000008                // Fall through to label ?Subroutine27
    113          //******************************************************************************
    114          //! 函数名：                 Single_WriteIIC
    115          //! 功能：                     向IIC设备写入一个字节数据
    116          //! 作者：                      帅帅
    117          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
    118          void Single_WriteIIC(uint8_t REG_Address,uint8_t REG_data)
   \                     Single_WriteIIC:
    119          {
   \   000000   1B14         PUSHM.A #0x2, R11
   \   000002   4B4C         MOV.B   R12, R11
   \   000004   4A4D         MOV.B   R13, R10
    120              IIC_Start();                  //起始信号
   \   000006   ........     CALLA   #?Subroutine7
   \                     ??Single_WriteIIC_0:
   \   00000A   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_36:
   \   00000E   FD2B         JNC     ??Single_WriteIIC_0
   \   000010   ........     CALLA   #IIC_RecvACK
    121              IIC_SendByte(SlaveAddress);   //发送设备地址+写信号
    122              IIC_SendByte(REG_Address);    //内部寄存器地址
   \   000014   4C4B         MOV.B   R11, R12
   \   000016   ........     CALLA   #IIC_SendByte
    123              IIC_SendByte(REG_data);       //内部寄存器数据
   \   00001A   4C4A         MOV.B   R10, R12
   \   00001C   ........     CALLA   #IIC_SendByte
    124              IIC_Stop();                   //发送停止信号
   \   000020   ........     CALLA   #IIC_Stop
    125          }
   \   000024   1A16         POPM.A  #0x2, R11
   \   000026   1001         RETA
   \   000028                REQUIRE _A_PBDIR_L
   \   000028                REQUIRE _A_PBOUT_L

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine7:
   \   000000   ........     CALLA   #IIC_Start
   \   000004   D2D32402     BIS.B   #0x1, &0x224
   \   000008   4F43         MOV.B   #0x0, R15
   \   00000A   1001         RETA
    126          
    127          //******************************************************************************
    128          //! 函数名：                 Single_ReadIIC
    129          //! 功能：                    从IIC设备读取一个字节数据
    130          //! 作者：                      帅帅
    131          //******************************************************************************

   \                                 In  segment CODE, align 2, keep-with-next
    132          uint8_t  Single_ReadIIC(uint8_t REG_Address)
   \                     Single_ReadIIC:
    133          {
   \   000000   4D4C         MOV.B   R12, R13
    134           uint8_t REG_data;
    135           IIC_Start();                   //起始信号
   \   000002   ........     CALLA   #?Subroutine7
   \                     ??Single_ReadIIC_0:
   \   000006   3E40D000     MOV.W   #0xd0, R14
   \   00000A   ........     CALLA   #?Subroutine22
   \                     ??CrossCallReturnLabel_43:
   \   00000E   ........     CALLA   #?Subroutine21
   \                     ??CrossCallReturnLabel_42:
   \   000012                ////////////// Start of 50 cycles delay.
   \   000012   3E400F00     MOV.W   #0xf, R14
   \                     ??Single_ReadIIC_8:
   \   000016   3E53         ADD.W   #0xffff, R14
   \   000018   FE2F         JC      ??Single_ReadIIC_8
   \   00001A                ////////////// End of delay code.
   \   00001A   E2C32202     BIC.B   #0x2, &0x222
   \   00001E                ////////////// Start of 50 cycles delay.
   \   00001E   3E400F00     MOV.W   #0xf, R14
   \                     ??Single_ReadIIC_9:
   \   000022   3E53         ADD.W   #0xffff, R14
   \   000024   FE2F         JC      ??Single_ReadIIC_9
   \   000026                ////////////// End of delay code.
   \   000026   5F53         ADD.B   #0x1, R15
   \   000028   7F92         CMP.B   #0x8, R15
   \   00002A   ED2B         JNC     ??Single_ReadIIC_0
   \   00002C   ........     CALLA   #IIC_RecvACK
    136           IIC_SendByte(SlaveAddress);    //发送设备地址+写信号
    137           IIC_SendByte(REG_Address);     //发送存储单元地址〈0开始
   \   000030   4C4D         MOV.B   R13, R12
   \   000032   ........     CALLA   #IIC_SendByte
    138           IIC_Start();                   //起始信号
   \   000036   ........     CALLA   #?Subroutine7
   \                     ??Single_ReadIIC_1:
   \   00003A   3E40D100     MOV.W   #0xd1, R14
   \   00003E   ........     CALLA   #??Subroutine29_2
   \                     ??CrossCallReturnLabel_39:
   \   000042   FB2B         JNC     ??Single_ReadIIC_1
   \   000044   ........     CALLA   #IIC_RecvACK
    139           IIC_SendByte(SlaveAddress+1);  //发送设备地址+读信号
    140           REG_data=IIC_RecvByte();       //读出寄存器数据
   \   000048   ........     CALLA   #IIC_RecvByte
    141           IIC_SendACK(1);                //接收应答信号
   \   00004C   ........     CALLA   #?Subroutine6
   \                     ??CrossCallReturnLabel_50:
   \   000050   ........     CALLA   #?Subroutine3
   \                     ??CrossCallReturnLabel_35:
   \   000054   ........     CALLA   #??Subroutine4_0
    142           IIC_Stop();                    //停止信号
   \                     ??CrossCallReturnLabel_55:
   \   000058   ........     BRA     #IIC_Stop
   \   00005C                REQUIRE _A_PBDIR_L
   \   00005C                REQUIRE _A_PBOUT_L
    143           return REG_data;
    144          }
    145          //******************************************************************************
    146          //! 函数名：                 MPU6050_INIT
    147          //! 功能：                     初始化MPU6050
    148          //! 作者：                      帅帅
    149          //******************************************************************************

   \                                 In  segment CODE, align 2
    150          void MPU6050_INIT(){
   \                     MPU6050_INIT:
   \   000000   0A14         PUSHM.A #0x1, R10
    151              Single_WriteIIC(PWR_MGMT_1, 0x00); //解除休眠状态
   \   000002   4D43         MOV.B   #0x0, R13
   \   000004   7C406B00     MOV.B   #0x6b, R12
   \   000008   ........     CALLA   #Single_WriteIIC
    152              Single_WriteIIC(SMPLRT_DIV, 0x07);
   \   00000C   7D400700     MOV.B   #0x7, R13
   \   000010   7C401900     MOV.B   #0x19, R12
   \   000014   ........     CALLA   #Single_WriteIIC
    153              Single_WriteIIC(CONFIG, 0x06);
   \   000018   7D400600     MOV.B   #0x6, R13
   \   00001C   7C401A00     MOV.B   #0x1a, R12
   \   000020   ........     CALLA   #Single_WriteIIC
    154              Single_WriteIIC(GYRO_CONFIG, 0x18);
   \   000024   ........     CALLA   #?Subroutine7
   \                     ??MPU6050_INIT_0:
   \   000028   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_37:
   \   00002C   FD2B         JNC     ??MPU6050_INIT_0
   \   00002E   ........     CALLA   #IIC_RecvACK
   \   000032   ........     MOVA    #IIC_SendByte, R10
   \   000036   7C401B00     MOV.B   #0x1b, R12
   \   00003A   4A13         CALLA   R10
   \   00003C   7C401800     MOV.B   #0x18, R12
   \   000040   4A13         CALLA   R10
   \   000042   ........     CALLA   #IIC_Stop
    155              Single_WriteIIC(ACCEL_CONFIG, 0x01);
   \   000046   ........     CALLA   #?Subroutine7
   \                     ??MPU6050_INIT_1:
   \   00004A   ........     CALLA   #?Subroutine2
   \                     ??CrossCallReturnLabel_38:
   \   00004E   FD2B         JNC     ??MPU6050_INIT_1
   \   000050   ........     CALLA   #IIC_RecvACK
   \   000054   7C401C00     MOV.B   #0x1c, R12
   \   000058   4A13         CALLA   R10
   \   00005A   5C43         MOV.B   #0x1, R12
   \   00005C   4A13         CALLA   R10
   \   00005E   ........     CALLA   #IIC_Stop
    156          }
   \   000062   0A16         POPM.A  #0x1, R10
   \   000064   1001         RETA
   \   000066                REQUIRE _A_PBDIR_L
   \   000066                REQUIRE _A_PBOUT_L
    157          //******************************************************************************
    158          //! 函数名：                 MPU6050_GET
    159          //! 功能：                     读取MPU6050
    160          //! 入口：                     选轴
    161          //! 作者：                     帅帅
    162          //******************************************************************************

   \                                 In  segment CODE, align 2
    163          int MPU6050_GET(uint8_t REG_Address){
   \                     MPU6050_GET:
   \   000000   1B14         PUSHM.A #0x2, R11
   \   000002   4B4C         MOV.B   R12, R11
    164              char H,L;
    165              H = Single_ReadIIC(REG_Address);
   \   000004   ........     CALLA   #Single_ReadIIC
    166              L = Single_ReadIIC(REG_Address+1);
    167              return ((H<<8)+L)/64;
   \   000008   4A4C         MOV.B   R12, R10
   \   00000A   8A10         SWPB    R10
   \   00000C   5B53         ADD.B   #0x1, R11
   \   00000E   4C4B         MOV.B   R11, R12
   \   000010   ........     CALLA   #Single_ReadIIC
   \   000014   4C4C         MOV.B   R12, R12
   \   000016   0C5A         ADD.W   R10, R12
   \   000018   3E404000     MOV.W   #0x40, R14
   \   00001C   ........     CALLA   #?DivMod16s
   \   000020   1A16         POPM.A  #0x2, R11
   \   000022   1001         RETA
    168          }
    169          
    170          //卡尔曼参数

   \                                 In  segment DATA20_I, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    171          float Q_angle = 0.05; //上次为0.05
   \                     Q_angle:
   \   000000                DS8 4
   \   000004                REQUIRE `?<Initializer for Q_angle>`

   \                                 In  segment DATA20_I, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    172          float Q_gyro  = 0.05;
   \                     Q_gyro:
   \   000000                DS8 4
   \   000004                REQUIRE `?<Initializer for Q_gyro>`

   \                                 In  segment DATA20_I, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    173          float R_angle = 0.06;
   \                     R_angle:
   \   000000                DS8 4
   \   000004                REQUIRE `?<Initializer for R_angle>`

   \                                 In  segment DATA20_I, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    174          float dt      = 0.01;//dt为kalman滤波器采样时间
   \                     dt:
   \   000000                DS8 4
   \   000004                REQUIRE `?<Initializer for dt>`
    175          

   \                                 In  segment DATA20_I, align 1, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    176          char  C_0     = 1;
   \                     C_0:
   \   000000                DS8 1
   \   000001                REQUIRE `?<Initializer for C_0>`

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    177          float Q_bias, Angle_err;
   \                     Q_bias:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Angle_err:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    178          float PCt_0, PCt_1, E;
   \                     PCt_0:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     PCt_1:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     E:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    179          float K_0, K_1, t_0, t_1;
   \                     K_0:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     K_1:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     t_0:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     t_1:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    180          float Pdot[4] ={0,0,0,0};
   \                     Pdot:
   \   000000                DS8 16

   \                                 In  segment DATA20_I, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_copy20
    181          float PP[2][2] = { { 1, 0 },{ 0, 1 } };
   \                     PP:
   \   000000                DS8 16
   \   000010                REQUIRE `?<Initializer for PP>`

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    182          float ax,ay,az,Gyro_x,Gyro_y,Gyro_z,Angle_x_temp,Angle_y_temp;
   \                     ax:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     ay:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     az:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Gyro_x:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Gyro_y:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Gyro_z:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Angle_x_temp:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Angle_y_temp:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    183          float Angle_X_Final_Kalman,Angle_Y_Final_Kalman;
   \                     Angle_X_Final_Kalman:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
   \                     Angle_Y_Final_Kalman:
   \   000000                DS8 4

   \                                 In  segment DATA20_Z, align 2, align-sorted
   \   000000                REQUIRE ?cstart_init_zero20
    184          float Angle_Y_Final_Kalman_last;
   \                     Angle_Y_Final_Kalman_last:
   \   000000                DS8 4
    185          //卡尔曼滤波函数

   \                                 In  segment CODE, align 2, keep-with-next
    186          void Kalman_Filter_X(float Accel,float Gyro) //卡尔曼函数
   \                     Kalman_Filter_X:
    187          {
   \   000000   7B14         PUSHM.A #0x8, R11
   \   000002   1D15         PUSHM.W #0x2, R13
    188          
    189              Angle_X_Final_Kalman += (Gyro - Q_bias) * dt; //先验估计
   \   000004   1F15         PUSHM.W #0x2, R15
   \   000006   ........     CALLA   #?Subroutine9
   \                     ??CrossCallReturnLabel_2:
   \   00000A   ........     MOVA    #Angle_X_Final_Kalman, R11
   \   00000E                REQUIRE ?Subroutine0
   \   00000E                // Fall through to label ?Subroutine0
    190          
    191              Pdot[0]=Q_angle - PP[0][1] - PP[1][0]; // Pk-先验估计误差协方差的微分
    192          
    193              Pdot[1]= -PP[1][1];
    194              Pdot[2]= -PP[1][1];
    195              Pdot[3]= Q_gyro;
    196          
    197          
    198              PP[0][0] += Pdot[0] * dt;   // Pk-先验估计误差协方差微分的积分
    199              PP[0][1] += Pdot[1] * dt;   // =先验估计误差协方差
    200              PP[1][0] += Pdot[2] * dt;
    201              PP[1][1] += Pdot[3] * dt;
    202          
    203          
    204              Angle_err = Accel - Angle_X_Final_Kalman;  //-先验估计
    205          
    206              PCt_0 = C_0 * PP[0][0];
    207              PCt_1 = C_0 * PP[1][0];
    208          
    209              E = R_angle + C_0 * PCt_0;
    210          
    211              K_0 = PCt_0 / E;
    212              K_1 = PCt_1 / E;
    213          
    214              t_0 = PCt_0;
    215              t_1 = C_0 * PP[0][1];
    216          
    217              PP[0][0] -= K_0 * t_0;       //后验估计误差协方差
    218              PP[0][1] -= K_0 * t_1;
    219              PP[1][0] -= K_1 * t_0;
    220              PP[1][1] -= K_1 * t_1;
    221          
    222              Angle_X_Final_Kalman += K_0 * Angle_err;    //后验估计
    223              Q_bias += K_1 * Angle_err;    //后验估计
    224          }

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine0:
   \   000000   0C4E         MOV.W   R14, R12
   \   000002   0D4F         MOV.W   R15, R13
   \   000004   ........     CALLA   #?Subroutine10
   \                     ??CrossCallReturnLabel_4:
   \   000008   ........     CALLA   #_Sub32f
   \   00000C   0E48         MOV.W   R8, R14
   \   00000E   0F49         MOV.W   R9, R15
   \   000010   ........     CALLA   #?Subroutine12
   \                     ??CrossCallReturnLabel_9:
   \   000014   ........     MOVA    #PP, R10
   \   000018   ....1C42.... MOVX.W  &Q_angle, R12
   \   00001E   ....1D42.... MOVX.W  &Q_angle + 2, R13
   \   000024   ........     CALLA   #?Subroutine15
   \                     ??CrossCallReturnLabel_13:
   \   000028   ........     CALLA   #_Sub32f
   \   00002C   ........     CALLA   #?Subroutine16
   \                     ??CrossCallReturnLabel_16:
   \   000030   ........     CALLA   #_Sub32f
   \   000034   ........     MOVA    #Pdot, R15
   \   000038   8F4C0000     MOV.W   R12, 0(R15)
   \   00003C   8F4D0200     MOV.W   R13, 0x2(R15)
   \   000040   144A0C00     MOV.W   0xc(R10), R4
   \   000044   154A0E00     MOV.W   0xe(R10), R5
   \   000048   35E00080     XOR.W   #0x8000, R5
   \   00004C   8F440400     MOV.W   R4, 0x4(R15)
   \   000050   8F450600     MOV.W   R5, 0x6(R15)
   \   000054   8F440800     MOV.W   R4, 0x8(R15)
   \   000058   8F450A00     MOV.W   R5, 0xa(R15)
   \   00005C   ....1642.... MOVX.W  &Q_gyro, R6
   \   000062   ....1742.... MOVX.W  &Q_gyro + 2, R7
   \   000068   8F460C00     MOV.W   R6, 0xc(R15)
   \   00006C   8F470E00     MOV.W   R7, 0xe(R15)
   \   000070   ........     CALLA   #??Subroutine14_0
   \                     ??CrossCallReturnLabel_57:
   \   000074   2E4A         MOV.W   @R10, R14
   \   000076   1F4A0200     MOV.W   0x2(R10), R15
   \   00007A   ........     CALLA   #_Add32f
   \   00007E   8A4C0000     MOV.W   R12, 0(R10)
   \   000082   8A4D0200     MOV.W   R13, 0x2(R10)
   \   000086   ........     CALLA   #?Subroutine14
   \                     ??CrossCallReturnLabel_60:
   \   00008A   044C         MOV.W   R12, R4
   \   00008C   054D         MOV.W   R13, R5
   \   00008E   ........     CALLA   #?Subroutine15
   \                     ??CrossCallReturnLabel_14:
   \   000092   ........     CALLA   #_Add32f
   \   000096   8A4C0400     MOV.W   R12, 0x4(R10)
   \   00009A   8A4D0600     MOV.W   R13, 0x6(R10)
   \   00009E   0C44         MOV.W   R4, R12
   \   0000A0   0D45         MOV.W   R5, R13
   \   0000A2   ........     CALLA   #?Subroutine16
   \                     ??CrossCallReturnLabel_17:
   \   0000A6   ........     CALLA   #_Add32f
   \   0000AA   8A4C0800     MOV.W   R12, 0x8(R10)
   \   0000AE   8A4D0A00     MOV.W   R13, 0xa(R10)
   \   0000B2   0C46         MOV.W   R6, R12
   \   0000B4   0D47         MOV.W   R7, R13
   \   0000B6   ........     CALLA   #??Subroutine14_0
   \                     ??CrossCallReturnLabel_58:
   \   0000BA   1E4A0C00     MOV.W   0xc(R10), R14
   \   0000BE   1F4A0E00     MOV.W   0xe(R10), R15
   \   0000C2   ........     CALLA   #_Add32f
   \   0000C6   8A4C0C00     MOV.W   R12, 0xc(R10)
   \   0000CA   8A4D0E00     MOV.W   R13, 0xe(R10)
   \   0000CE   1C410400     MOV.W   0x4(SP), R12
   \   0000D2   1D410600     MOV.W   0x6(SP), R13
   \   0000D6   2E4B         MOV.W   @R11, R14
   \   0000D8   1F4B0200     MOV.W   0x2(R11), R15
   \   0000DC   ........     CALLA   #_Sub32f
   \   0000E0   ....824C.... MOVX.W  R12, &Angle_err
   \   0000E6   ....824D.... MOVX.W  R13, &Angle_err + 2
   \   0000EC   ....5C42.... MOVX.B  &C_0, R12
   \   0000F2   0D43         MOV.W   #0x0, R13
   \   0000F4   ........     CALLA   #_Cast32uto32f
   \   0000F8   084C         MOV.W   R12, R8
   \   0000FA   094D         MOV.W   R13, R9
   \   0000FC   2E4A         MOV.W   @R10, R14
   \   0000FE   1F4A0200     MOV.W   0x2(R10), R15
   \   000102   ........     CALLA   #_Mul32f
   \   000106   064C         MOV.W   R12, R6
   \   000108   074D         MOV.W   R13, R7
   \   00010A   ....824C.... MOVX.W  R12, &PCt_0
   \   000110   ....824D.... MOVX.W  R13, &PCt_0 + 2
   \   000116   0C48         MOV.W   R8, R12
   \   000118   0D49         MOV.W   R9, R13
   \   00011A   ........     CALLA   #?Subroutine16
   \                     ??CrossCallReturnLabel_18:
   \   00011E   ........     CALLA   #_Mul32f
   \   000122   ....824C.... MOVX.W  R12, &PCt_1
   \   000128   ....824D.... MOVX.W  R13, &PCt_1 + 2
   \   00012E   0C48         MOV.W   R8, R12
   \   000130   0D49         MOV.W   R9, R13
   \   000132   ........     CALLA   #?Subroutine17
   \                     ??CrossCallReturnLabel_19:
   \   000136   ....1E42.... MOVX.W  &R_angle, R14
   \   00013C   ....1F42.... MOVX.W  &R_angle + 2, R15
   \   000142   ........     CALLA   #_Add32f
   \   000146   044C         MOV.W   R12, R4
   \   000148   054D         MOV.W   R13, R5
   \   00014A   ....824C.... MOVX.W  R12, &E
   \   000150   ....824D.... MOVX.W  R13, &E + 2
   \   000156   0C46         MOV.W   R6, R12
   \   000158   0D47         MOV.W   R7, R13
   \   00015A   0E44         MOV.W   R4, R14
   \   00015C   0F45         MOV.W   R5, R15
   \   00015E   ........     CALLA   #_Div32f
   \   000162   ....824C.... MOVX.W  R12, &K_0
   \   000168   ....824D.... MOVX.W  R13, &K_0 + 2
   \   00016E   ....1C42.... MOVX.W  &PCt_1, R12
   \   000174   ....1D42.... MOVX.W  &PCt_1 + 2, R13
   \   00017A   0E44         MOV.W   R4, R14
   \   00017C   0F45         MOV.W   R5, R15
   \   00017E   ........     CALLA   #_Div32f
   \   000182   044C         MOV.W   R12, R4
   \   000184   054D         MOV.W   R13, R5
   \   000186   ....824C.... MOVX.W  R12, &K_1
   \   00018C   ....824D.... MOVX.W  R13, &K_1 + 2
   \   000192   ....8246.... MOVX.W  R6, &t_0
   \   000198   ....8247.... MOVX.W  R7, &t_0 + 2
   \   00019E   0C48         MOV.W   R8, R12
   \   0001A0   0D49         MOV.W   R9, R13
   \   0001A2   ........     CALLA   #?Subroutine15
   \                     ??CrossCallReturnLabel_15:
   \   0001A6   ........     CALLA   #_Mul32f
   \   0001AA   084C         MOV.W   R12, R8
   \   0001AC   094D         MOV.W   R13, R9
   \   0001AE   ....824C.... MOVX.W  R12, &t_1
   \   0001B4   ....824D.... MOVX.W  R13, &t_1 + 2
   \   0001BA   2C4A         MOV.W   @R10, R12
   \   0001BC   1D4A0200     MOV.W   0x2(R10), R13
   \   0001C0   1D15         PUSHM.W #0x2, R13
   \   0001C2   ........     CALLA   #?Subroutine18
   \                     ??CrossCallReturnLabel_22:
   \   0001C6   ........     CALLA   #?Subroutine17
   \                     ??CrossCallReturnLabel_20:
   \   0001CA   0E4C         MOV.W   R12, R14
   \   0001CC   0F4D         MOV.W   R13, R15
   \   0001CE   1C17         POPM.W  #0x2, R13
   \   0001D0   ........     CALLA   #_Sub32f
   \   0001D4   8A4C0000     MOV.W   R12, 0(R10)
   \   0001D8   8A4D0200     MOV.W   R13, 0x2(R10)
   \   0001DC   1C4A0400     MOV.W   0x4(R10), R12
   \   0001E0   1D4A0600     MOV.W   0x6(R10), R13
   \   0001E4   1D15         PUSHM.W #0x2, R13
   \   0001E6   ........     CALLA   #?Subroutine18
   \                     ??CrossCallReturnLabel_23:
   \   0001EA   ........     CALLA   #??Subroutine14_0
   \                     ??CrossCallReturnLabel_59:
   \   0001EE   0E4C         MOV.W   R12, R14
   \   0001F0   0F4D         MOV.W   R13, R15
   \   0001F2   1C17         POPM.W  #0x2, R13
   \   0001F4   ........     CALLA   #_Sub32f
   \   0001F8   8A4C0400     MOV.W   R12, 0x4(R10)
   \   0001FC   8A4D0600     MOV.W   R13, 0x6(R10)
   \   000200   1C4A0800     MOV.W   0x8(R10), R12
   \   000204   1D4A0A00     MOV.W   0xa(R10), R13
   \   000208   1D15         PUSHM.W #0x2, R13
   \   00020A   0C44         MOV.W   R4, R12
   \   00020C   0D45         MOV.W   R5, R13
   \   00020E   ........     CALLA   #?Subroutine17
   \                     ??CrossCallReturnLabel_21:
   \   000212   0E4C         MOV.W   R12, R14
   \   000214   0F4D         MOV.W   R13, R15
   \   000216   1C17         POPM.W  #0x2, R13
   \   000218   ........     CALLA   #_Sub32f
   \   00021C   8A4C0800     MOV.W   R12, 0x8(R10)
   \   000220   8A4D0A00     MOV.W   R13, 0xa(R10)
   \   000224   164A0C00     MOV.W   0xc(R10), R6
   \   000228   174A0E00     MOV.W   0xe(R10), R7
   \   00022C   ........     CALLA   #?Subroutine14
   \                     ??CrossCallReturnLabel_61:
   \   000230   0E4C         MOV.W   R12, R14
   \   000232   0F4D         MOV.W   R13, R15
   \   000234   0C46         MOV.W   R6, R12
   \   000236   0D47         MOV.W   R7, R13
   \   000238   ........     CALLA   #_Sub32f
   \   00023C   8A4C0C00     MOV.W   R12, 0xc(R10)
   \   000240   8A4D0E00     MOV.W   R13, 0xe(R10)
   \   000244   ........     CALLA   #?Subroutine18
   \                     ??CrossCallReturnLabel_24:
   \   000248   ........     CALLA   #?Subroutine19
   \                     ??CrossCallReturnLabel_25:
   \   00024C   ........     CALLA   #?Subroutine12
   \                     ??CrossCallReturnLabel_10:
   \   000250   0C44         MOV.W   R4, R12
   \   000252   0D45         MOV.W   R5, R13
   \   000254   ........     CALLA   #?Subroutine19
   \                     ??CrossCallReturnLabel_26:
   \   000258   ........     CALLA   #_Mul32f
   \   00025C   ........     CALLA   #?Subroutine10
   \                     ??CrossCallReturnLabel_5:
   \   000260   ........     CALLA   #_Add32f
   \   000264   ....824C.... MOVX.W  R12, &Q_bias
   \   00026A   ....824D.... MOVX.W  R13, &Q_bias + 2
   \   000270   A1000800     ADDA    #0x8, SP
   \   000274   7416         POPM.A  #0x8, R11
   \   000276   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine19:
   \   000000   ....1E42.... MOVX.W  &Angle_err, R14
   \   000006   ....1F42.... MOVX.W  &Angle_err + 2, R15
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine18:
   \   000000   ....1C42.... MOVX.W  &K_0, R12
   \   000006   ....1D42.... MOVX.W  &K_0 + 2, R13
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine17:
   \   000000   0E46         MOV.W   R6, R14
   \   000002   0F47         MOV.W   R7, R15
   \   000004   ........     BRA     #_Mul32f

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine16:
   \   000000   1E4A0800     MOV.W   0x8(R10), R14
   \   000004   1F4A0A00     MOV.W   0xa(R10), R15
   \   000008   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine15:
   \   000000   1E4A0400     MOV.W   0x4(R10), R14
   \   000004   1F4A0600     MOV.W   0x6(R10), R15
   \   000008   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine12:
   \   000000   ........     CALLA   #_Mul32f
   \   000004   2E4B         MOV.W   @R11, R14
   \   000006   1F4B0200     MOV.W   0x2(R11), R15
   \   00000A   ........     CALLA   #_Add32f
   \   00000E   8B4C0000     MOV.W   R12, 0(R11)
   \   000012   8B4D0200     MOV.W   R13, 0x2(R11)
   \   000016   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine10:
   \   000000   ....1E42.... MOVX.W  &Q_bias, R14
   \   000006   ....1F42.... MOVX.W  &Q_bias + 2, R15
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine9:
   \   000000   ....1842.... MOVX.W  &dt, R8
   \   000006   ....1942.... MOVX.W  &dt + 2, R9
   \   00000C   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine14:
   \   000000   0C44         MOV.W   R4, R12
   \   000002   0D45         MOV.W   R5, R13
   \   000004                REQUIRE ??Subroutine14_0
   \   000004                // Fall through to label ??Subroutine14_0

   \                                 In  segment CODE, align 2
   \                     ??Subroutine14_0:
   \   000000   0E48         MOV.W   R8, R14
   \   000002   0F49         MOV.W   R9, R15
   \   000004   ........     BRA     #_Mul32f
    225          

   \                                 In  segment CODE, align 2
    226          void Kalman_Filter_Y(float Accel,float Gyro) //卡尔曼函数
   \                     Kalman_Filter_Y:
    227          {
   \   000000   7B14         PUSHM.A #0x8, R11
   \   000002   1D15         PUSHM.W #0x2, R13
    228              Angle_Y_Final_Kalman += (Gyro - Q_bias) * dt; //先验估计
   \   000004   1F15         PUSHM.W #0x2, R15
   \   000006   ........     CALLA   #?Subroutine9
   \                     ??CrossCallReturnLabel_3:
   \   00000A   ........     MOVA    #Angle_Y_Final_Kalman, R11
   \   00000E   ....         JMP     ?Subroutine0
   \   000010   0343         NOP
    229          
    230              Pdot[0]=Q_angle - PP[0][1] - PP[1][0]; // Pk-先验估计误差协方差的微分
    231          
    232              Pdot[1]=- PP[1][1];
    233              Pdot[2]=- PP[1][1];
    234              Pdot[3]=Q_gyro;
    235          
    236              PP[0][0] += Pdot[0] * dt;   // Pk-先验估计误差协方差微分的积分
    237              PP[0][1] += Pdot[1] * dt;   // =先验估计误差协方差
    238              PP[1][0] += Pdot[2] * dt;
    239              PP[1][1] += Pdot[3] * dt;
    240          
    241              Angle_err=Accel-Angle_Y_Final_Kalman;  //-先验估计
    242          
    243              PCt_0 = C_0 * PP[0][0];
    244              PCt_1 = C_0 * PP[1][0];
    245          
    246              E = R_angle + C_0 * PCt_0;
    247          
    248              K_0 = PCt_0 / E;
    249              K_1 = PCt_1 / E;
    250          
    251              t_0 = PCt_0;
    252              t_1 = C_0 * PP[0][1];
    253          
    254              PP[0][0] -= K_0 * t_0;       //后验估计误差协方差
    255              PP[0][1] -= K_0 * t_1;
    256              PP[1][0] -= K_1 * t_0;
    257              PP[1][1] -= K_1 * t_1;
    258          
    259              Angle_Y_Final_Kalman   += K_0 * Angle_err;  //后验估计
    260              Q_bias  += K_1 * Angle_err;  //后验估计
    261          }
    262          ///******************
    263          // * @brief 陀螺仪数据采集
    264          // * @param 无；
    265          // * @see MPU6050_Tim();
    266          // *
    267          // * */
    268          //

   \                                 In  segment CODE, align 2
    269          void MPU6050_Tim(void)
   \                     MPU6050_Tim:
    270          {
   \   000000   7B14         PUSHM.A #0x8, R11
   \   000002   F103         SUBA    #0x2, SP
    271          //    char txt[16];
    272              short aacx,aacy,aacz;    //加速度传感器原始数据
    273              short gyrox,gyroy,gyroz; //陀螺仪原始数据
    274          
    275          //    MPU_Get_Raw_data(&aacx,&aacy,&aacz,&gyrox,&gyroy,&gyroz);   //得到加速度传感器数据
    276              aacx = MPU6050_GET(ACCEL_XOUT_H);
   \   000004   ........     MOVA    #MPU6050_GET, R8
   \   000008   7C403B00     MOV.B   #0x3b, R12
   \   00000C   4813         CALLA   R8
   \   00000E   074C         MOV.W   R12, R7
    277              aacy = MPU6050_GET(ACCEL_YOUT_H);
   \   000010   7C403D00     MOV.B   #0x3d, R12
   \   000014   4813         CALLA   R8
   \   000016   0B4C         MOV.W   R12, R11
    278              aacz = MPU6050_GET(ACCEL_ZOUT_H);
   \   000018   7C403F00     MOV.B   #0x3f, R12
   \   00001C   4813         CALLA   R8
   \   00001E   0A4C         MOV.W   R12, R10
    279              gyrox = MPU6050_GET(GYRO_XOUT_H);
   \   000020   7C404300     MOV.B   #0x43, R12
   \   000024   4813         CALLA   R8
   \   000026   814C0000     MOV.W   R12, 0(SP)
    280              gyroy = MPU6050_GET(GYRO_YOUT_H);
   \   00002A   7C404500     MOV.B   #0x45, R12
   \   00002E   4813         CALLA   R8
   \   000030   044C         MOV.W   R12, R4
    281              gyroz = MPU6050_GET(GYRO_ZOUT_H);
   \   000032   7C404700     MOV.B   #0x47, R12
   \   000036   4813         CALLA   R8
   \   000038   054C         MOV.W   R12, R5
    282          
    283              ax = (9.8*aacx)/8192;//姿态解算
   \   00003A   0C47         MOV.W   R7, R12
   \   00003C   0D47         MOV.W   R7, R13
   \   00003E   ........     CALLA   #?Subroutine11
   \                     ??CrossCallReturnLabel_6:
   \   000042   084C         MOV.W   R12, R8
   \   000044   094D         MOV.W   R13, R9
   \   000046   ....824C.... MOVX.W  R12, &ax
   \   00004C   ....824D.... MOVX.W  R13, &ax + 2
    284              ay = (9.8*aacy)/8192;
   \   000052   0C4B         MOV.W   R11, R12
   \   000054   0D4B         MOV.W   R11, R13
   \   000056   ........     CALLA   #?Subroutine11
   \                     ??CrossCallReturnLabel_7:
   \   00005A   064C         MOV.W   R12, R6
   \   00005C   074D         MOV.W   R13, R7
   \   00005E   ....824C.... MOVX.W  R12, &ay
   \   000064   ....824D.... MOVX.W  R13, &ay + 2
    285              az = (9.8*aacz)/8192;
   \   00006A   0C4A         MOV.W   R10, R12
   \   00006C   0D4A         MOV.W   R10, R13
   \   00006E   ........     CALLA   #?Subroutine11
   \                     ??CrossCallReturnLabel_8:
   \   000072   0A4C         MOV.W   R12, R10
   \   000074   0B4D         MOV.W   R13, R11
   \   000076   ....824C.... MOVX.W  R12, &az
   \   00007C   ....824D.... MOVX.W  R13, &az + 2
   \   000082   2C41         MOV.W   @SP, R12
   \   000084   0D4C         MOV.W   R12, R13
   \   000086   ........     CALLA   #?Subroutine20
   \                     ??CrossCallReturnLabel_27:
   \   00008A   ....824C.... MOVX.W  R12, &Gyro_x
   \   000090   ....824D.... MOVX.W  R13, &Gyro_x + 2
    286          
    287              Gyro_x = (gyrox)/16.4;
    288              Gyro_y = (gyroy)/16.4;
   \   000096   0C44         MOV.W   R4, R12
   \   000098   0D44         MOV.W   R4, R13
   \   00009A   ........     CALLA   #?Subroutine20
   \                     ??CrossCallReturnLabel_28:
   \   00009E   ....824C.... MOVX.W  R12, &Gyro_y
   \   0000A4   ....824D.... MOVX.W  R13, &Gyro_y + 2
   \   0000AA   ........     MOVA    #Gyro_z, R4
   \   0000AE   0C45         MOV.W   R5, R12
   \   0000B0   0D45         MOV.W   R5, R13
   \   0000B2   ........     CALLA   #?Subroutine20
   \                     ??CrossCallReturnLabel_29:
   \   0000B6   844C0000     MOV.W   R12, 0(R4)
   \   0000BA   844D0200     MOV.W   R13, 0x2(R4)
    289              Gyro_z = (gyroz)/16.4;
    290          
    291          
    292              //用加速度计算三个轴和水平面坐标系之间的夹角
    293          //    Angle_x_temp=(atan((float)(ay)/(float)(az)))*180/3.14;   //计算x轴夹角
    294              Angle_y_temp=(atan((float)(ax)/(float)(az)))*180/3.14;   //计算y轴夹角
   \   0000BE   0C48         MOV.W   R8, R12
   \   0000C0   0D49         MOV.W   R9, R13
   \   0000C2   0E4A         MOV.W   R10, R14
   \   0000C4   0F4B         MOV.W   R11, R15
   \   0000C6   ........     CALLA   #?Subroutine13
   \                     ??CrossCallReturnLabel_12:
   \   0000CA   ....824C.... MOVX.W  R12, &Angle_y_temp
   \   0000D0   ....824D.... MOVX.W  R13, &Angle_y_temp + 2
    295          
    296              Angle_x_temp = (atan(ay / sqrt(pow(ax, 2) + pow(az, 2))) * 180 / 3.14);
   \   0000D6   0C48         MOV.W   R8, R12
   \   0000D8   0D49         MOV.W   R9, R13
   \   0000DA   ........     CALLA   #??Subroutine14_0
   \                     ??CrossCallReturnLabel_56:
   \   0000DE   084C         MOV.W   R12, R8
   \   0000E0   094D         MOV.W   R13, R9
   \   0000E2   0C4A         MOV.W   R10, R12
   \   0000E4   0D4B         MOV.W   R11, R13
   \   0000E6   0E4A         MOV.W   R10, R14
   \   0000E8   0F4B         MOV.W   R11, R15
   \   0000EA   ........     CALLA   #_Mul32f
   \   0000EE   0E48         MOV.W   R8, R14
   \   0000F0   0F49         MOV.W   R9, R15
   \   0000F2   ........     CALLA   #_Add32f
   \   0000F6   ........     CALLA   #sqrt
   \   0000FA   0E4C         MOV.W   R12, R14
   \   0000FC   0F4D         MOV.W   R13, R15
   \   0000FE   0C46         MOV.W   R6, R12
   \   000100   0D47         MOV.W   R7, R13
   \   000102   ........     CALLA   #?Subroutine13
   \                     ??CrossCallReturnLabel_11:
   \   000106   ....824C.... MOVX.W  R12, &Angle_x_temp
   \   00010C   ....824D.... MOVX.W  R13, &Angle_x_temp + 2
    297              Kalman_Filter_X(Angle_x_temp,Gyro_z);
   \   000112   2E44         MOV.W   @R4, R14
   \   000114   1F440200     MOV.W   0x2(R4), R15
   \   000118   ........     CALLA   #Kalman_Filter_X
    298              Kalman_Filter_Y(Angle_y_temp,Gyro_z);
   \   00011C   3E44         MOV.W   @R4+, R14
   \   00011E   3F44         MOV.W   @R4+, R15
   \   000120   ....1C42.... MOVX.W  &Angle_y_temp, R12
   \   000126   ....1D42.... MOVX.W  &Angle_y_temp + 2, R13
   \   00012C   ........     CALLA   #Kalman_Filter_Y
    299          //    sprintf(txt,"Angle_X:%f", Angle_X_Final_Kalman);
    300          //    TFTSPI_P6X8Str(1,12,txt,u16YELLOW, u16BLUE);
    301          //    OLED_DispDecAt(FONT_ASCII_6X8,3,50,Angle_X_Final_Kalman,3);          //显示接收到的数据加速度Y
    302          //    OLED_DispDecAt(FONT_ASCII_6X8,5,50,Angle_Y_Final_Kalman,3);          //显示接收到的数据加速度Z
    303          }
   \   000130   E103         ADDA    #0x2, SP
   \   000132   7416         POPM.A  #0x8, R11
   \   000134   1001         RETA

   \                                 In  segment CODE, align 2
   \                     ?Subroutine20:
   \   000000   ........     CALLA   #?Subroutine24
   \                     ??CrossCallReturnLabel_33:
   \   000004   3E403333     MOV.W   #0x3333, R14
   \   000008   3F408341     MOV.W   #0x4183, R15
   \   00000C   ........     BRA     #_Div32f

   \                                 In  segment CODE, align 2
   \                     ?Subroutine13:
   \   000000   ........     CALLA   #_Div32f
   \   000004   ........     CALLA   #atan
   \   000008   0E43         MOV.W   #0x0, R14
   \   00000A   3F403443     MOV.W   #0x4334, R15
   \   00000E   ........     CALLA   #_Mul32f
   \   000012   3E40C3F5     MOV.W   #0xf5c3, R14
   \   000016   3F404840     MOV.W   #0x4048, R15
   \   00001A   ........     BRA     #_Div32f

   \                                 In  segment CODE, align 2
   \                     ?Subroutine11:
   \   000000   ........     CALLA   #?Subroutine24
   \                     ??CrossCallReturnLabel_32:
   \   000004   3E40CDCC     MOV.W   #0xcccd, R14
   \   000008   3F401C41     MOV.W   #0x411c, R15
   \   00000C   ........     CALLA   #_Mul32f
   \   000010   0E43         MOV.W   #0x0, R14
   \   000012   3F400039     MOV.W   #0x3900, R15
   \   000016   ........     BRA     #_Mul32f

   \                                 In  segment CODE, align 2
   \                     ?Subroutine24:
   \   000000   0D5D         RLA.W   R13
   \   000002   0D7D         SUBC.W  R13, R13
   \   000004   3DE3         XOR.W   #0xffff, R13
   \   000006   ........     BRA     #_Cast32sto32f

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine2:
   \   000000   3E40D000     MOV.W   #0xd0, R14
   \   000004                REQUIRE ??Subroutine29_2
   \   000004                // Fall through to label ??Subroutine29_2

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ??Subroutine29_2:
   \   000000   ........     CALLA   #?Subroutine22
   \                     ??CrossCallReturnLabel_44:
   \   000004   ........     CALLA   #?Subroutine21
   \                     ??CrossCallReturnLabel_40:
   \   000008                ////////////// Start of 50 cycles delay.
   \   000008   3E400F00     MOV.W   #0xf, R14
   \                     ??Subroutine29_0:
   \   00000C   3E53         ADD.W   #0xffff, R14
   \   00000E   FE2F         JC      ??Subroutine29_0
   \   000010                ////////////// End of delay code.
   \   000010   E2C32202     BIC.B   #0x2, &0x222
   \   000014                ////////////// Start of 50 cycles delay.
   \   000014   3E400F00     MOV.W   #0xf, R14
   \                     ??Subroutine29_1:
   \   000018   3E53         ADD.W   #0xffff, R14
   \   00001A   FE2F         JC      ??Subroutine29_1
   \   00001C                ////////////// End of delay code.
   \   00001C   5F53         ADD.B   #0x1, R15
   \   00001E   7F92         CMP.B   #0x8, R15
   \   000020   1001         RETA

   \                                 In  segment CODE, align 2, keep-with-next
   \                     ?Subroutine22:
   \   000000   5F83         SUB.B   #0x1, R15
   \   000002   0230         JN      ??Single_WriteIIC_1
   \   000004                RPT     R15
   \   000004   CF180E5E     RLAX.W  R14
   \                     ??Single_WriteIIC_1:
   \   000008   5F53         ADD.B   #0x1, R15
   \   00000A   7EB08000     BIT.B   #0x80, R14
   \   00000E   1001         RETA

   \                                 In  segment DATA20_ID, align 2, align-sorted
   \                     `?<Initializer for Q_angle>`:
   \   000000   CDCC4C3D     DC32 3D4CCCCDH

   \                                 In  segment DATA20_ID, align 2, align-sorted
   \                     `?<Initializer for Q_gyro>`:
   \   000000   CDCC4C3D     DC32 3D4CCCCDH

   \                                 In  segment DATA20_ID, align 2, align-sorted
   \                     `?<Initializer for R_angle>`:
   \   000000   8FC2753D     DC32 3D75C28FH

   \                                 In  segment DATA20_ID, align 2, align-sorted
   \                     `?<Initializer for dt>`:
   \   000000   0AD7233C     DC32 3C23D70AH

   \                                 In  segment DATA20_ID, align 1, align-sorted
   \                     `?<Initializer for C_0>`:
   \   000000   01           DC8 1

   \                                 In  segment DATA20_ID, align 2, align-sorted
   \                     `?<Initializer for PP>`:
   \   000000   0000803F0000 DC32 3F800000H, 0H, 0H, 3F800000H
   \            000000000000
   \            0000803F    

   Maximum stack usage in bytes:

   CSTACK Function
   ------ --------
      4   IIC_RecvACK
      4   IIC_RecvByte
      4   IIC_SendACK
      4   IIC_SendByte
        0   -> IIC_RecvACK
      4   IIC_Start
      4   IIC_Stop
     44   Kalman_Filter_X
       44 _Add32f
       48 _Add32f
       44 _Cast32uto32f
       44 _Div32f
       44 _Mul32f
       48 _Mul32f
       44 _Sub32f
     44   Kalman_Filter_Y
       44 _Add32f
       48 _Add32f
       44 _Cast32uto32f
       44 _Div32f
       44 _Mul32f
       48 _Mul32f
       44 _Sub32f
     12   MPU6050_GET
       12   -> Single_ReadIIC
       12 ?DivMod16s
      8   MPU6050_INIT
        8   -> IIC_RecvACK
        8   -> IIC_SendByte
       12   -> IIC_Start
        8   -> IIC_Stop
        8   -> Single_WriteIIC
     38   MPU6050_Tim
       38   -> Kalman_Filter_X
       38   -> Kalman_Filter_Y
       38   -> MPU6050_GET
       42   -> atan
       38   -> sqrt
       38 _Add32f
       42 _Cast32sto32f
       38 _Div32f
       42 _Div32f
       38 _Mul32f
       42 _Mul32f
      4   Single_ReadIIC
        4   -> IIC_RecvACK
        4   -> IIC_RecvByte
        4   -> IIC_SendByte
        8   -> IIC_Start
        0   -> IIC_Stop
     12   Single_WriteIIC
       12   -> IIC_RecvACK
       12   -> IIC_SendByte
       16   -> IIC_Start
       12   -> IIC_Stop


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       1  ?<Initializer for C_0>
      16  ?<Initializer for PP>
       4  ?<Initializer for Q_angle>
       4  ?<Initializer for Q_gyro>
       4  ?<Initializer for R_angle>
       4  ?<Initializer for dt>
       8  ??Subroutine14_0
      34  ??Subroutine29_2
      14  ??Subroutine3_0
      10  ??Subroutine4_0
     632  ?Subroutine0
      14  ?Subroutine10
      26  ?Subroutine11
      24  ?Subroutine12
      30  ?Subroutine13
       4  ?Subroutine14
      10  ?Subroutine15
      10  ?Subroutine16
       8  ?Subroutine17
      14  ?Subroutine18
      14  ?Subroutine19
       4  ?Subroutine2
      16  ?Subroutine20
       6  ?Subroutine21
      16  ?Subroutine22
      10  ?Subroutine23
      10  ?Subroutine24
      10  ?Subroutine25
      10  ?Subroutine26
       6  ?Subroutine27
       4  ?Subroutine3
       4  ?Subroutine4
       8  ?Subroutine6
      12  ?Subroutine7
       4  ?Subroutine8
      14  ?Subroutine9
       4  Angle_X_Final_Kalman
       4  Angle_Y_Final_Kalman
       4  Angle_Y_Final_Kalman_last
       4  Angle_err
       4  Angle_x_temp
       4  Angle_y_temp
       1  C_0
       4  E
       4  Gyro_x
       4  Gyro_y
       4  Gyro_z
      32  IIC_RecvACK
      46  IIC_RecvByte
      20  IIC_SendACK
      46  IIC_SendByte
      18  IIC_Start
      18  IIC_Stop
       4  K_0
       4  K_1
      14  Kalman_Filter_X
      18  Kalman_Filter_Y
      36  MPU6050_GET
     102  MPU6050_INIT
     310  MPU6050_Tim
       4  PCt_0
       4  PCt_1
      16  PP
      16  Pdot
       4  Q_angle
       4  Q_bias
       4  Q_gyro
       4  R_angle
      92  Single_ReadIIC
      40  Single_WriteIIC
       2  _A_PBDIR_L
       2  _A_PBIN_L
       2  _A_PBOUT_L
       4  ax
       4  ay
       4  az
       4  dt
       4  t_0
       4  t_1

 
 1 778 bytes in segment CODE
     6 bytes in segment DATA16_AN
    33 bytes in segment DATA20_I
    33 bytes in segment DATA20_ID
    96 bytes in segment DATA20_Z
 
 1 778 bytes of CODE  memory
    33 bytes of CONST memory
   129 bytes of DATA  memory (+ 6 bytes shared)

Errors: none
Warnings: none
